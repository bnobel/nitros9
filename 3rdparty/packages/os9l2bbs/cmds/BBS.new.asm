         nam   BBS.new
         ttl   program module       

* Disassembled 2010/01/24 10:34:52 by Disasm v1.5 (C) 1988 by RML

         ifp1
         use   /dd/defs/defsfile
         endc
tylg     set   Prgrm+Objct   
atrv     set   ReEnt+rev
rev      set   $01
         mod   eom,name,tylg,atrv,start,size
u0000    rmb   1
u0001    rmb   1
u0002    rmb   1
u0003    rmb   1
u0004    rmb   1
u0005    rmb   1
u0006    rmb   1
u0007    rmb   3
u000A    rmb   1
u000B    rmb   1
u000C    rmb   2
u000E    rmb   2
u0010    rmb   2
u0012    rmb   2
u0014    rmb   2
u0016    rmb   2
u0018    rmb   2
u001A    rmb   6
u0020    rmb   2
u0022    rmb   2
u0024    rmb   2
u0026    rmb   16
u0036    rmb   6
u003C    rmb   3
u003F    rmb   1
u0040    rmb   9
u0049    rmb   1
u004A    rmb   1
u004B    rmb   2
u004D    rmb   1
u004E    rmb   1
u004F    rmb   1
u0050    rmb   1
u0051    rmb   1
u0052    rmb   1
u0053    rmb   1
u0054    rmb   1
u0055    rmb   1
u0056    rmb   1
u0057    rmb   1
u0058    rmb   1
u0059    rmb   1
u005A    rmb   1
u005B    rmb   1
u005C    rmb   64
u009C    rmb   80
u00EC    rmb   2
u00EE    rmb   2
u00F0    rmb   20
u0104    rmb   30
u0122    rmb   1
u0123    rmb   1
u0124    rmb   1
u0125    rmb   1
u0126    rmb   4
u012A    rmb   2
u012C    rmb   400
size     equ   .
name     equ   *
         fcs   /BBS.new/
         fcb   $43 C
         fcb   $6F o
         fcb   $70 p
         fcb   $79 y
         fcb   $72 r
         fcb   $69 i
         fcb   $67 g
         fcb   $68 h
         fcb   $74 t
         fcb   $20 
         fcb   $28 (
         fcb   $43 C
         fcb   $29 )
         fcb   $20 
         fcb   $31 1
         fcb   $39 9
         fcb   $38 8
         fcb   $38 8
         fcb   $42 B
         fcb   $79 y
         fcb   $20 
         fcb   $4B K
         fcb   $65 e
         fcb   $69 i
         fcb   $74 t
         fcb   $68 h
         fcb   $20 
         fcb   $41 A
         fcb   $6C l
         fcb   $70 p
         fcb   $68 h
         fcb   $6F o
         fcb   $6E n
         fcb   $73 s
         fcb   $6F o
         fcb   $4C L
         fcb   $69 i
         fcb   $63 c
         fcb   $65 e
         fcb   $6E n
         fcb   $63 c
         fcb   $65 e
         fcb   $64 d
         fcb   $20 
         fcb   $74 t
         fcb   $6F o
         fcb   $20 
         fcb   $41 A
         fcb   $6C l
         fcb   $70 p
         fcb   $68 h
         fcb   $61 a
         fcb   $20 
         fcb   $53 S
         fcb   $6F o
         fcb   $66 f
         fcb   $74 t
         fcb   $77 w
         fcb   $61 a
         fcb   $72 r
         fcb   $65 e
         fcb   $20 
         fcb   $54 T
         fcb   $65 e
         fcb   $63 c
         fcb   $68 h
         fcb   $6E n
         fcb   $6F o
         fcb   $6C l
         fcb   $6F o
         fcb   $67 g
         fcb   $69 i
         fcb   $65 e
         fcb   $73 s
         fcb   $41 A
         fcb   $6C l
         fcb   $6C l
         fcb   $20 
         fcb   $72 r
         fcb   $69 i
         fcb   $67 g
         fcb   $68 h
         fcb   $74 t
         fcb   $73 s
         fcb   $20 
         fcb   $72 r
         fcb   $65 e
         fcb   $73 s
         fcb   $65 e
         fcb   $72 r
         fcb   $76 v
         fcb   $65 e
         fcb   $64 d
         fcb   $EC l
         fcb   $E6 f
         fcb   $EA j
         fcb   $F5 u
         fcb   $E9 i
         fcb   $A0 
         fcb   $E2 b
         fcb   $ED m
         fcb   $F1 q
         fcb   $E9 i
         fcb   $F0 p
         fcb   $EF o
         fcb   $F4 t
         fcb   $F0 p
L007F    fcb   $42 B
         fcb   $42 B
         fcb   $53 S
         fcb   $2E .
         fcb   $6D m
         fcb   $73 s
         fcb   $67 g
         fcb   $2E .
         fcb   $69 i
         fcb   $6E n
         fcb   $78 x
         fcb   $0D 
L008B    fcb   $42 B
         fcb   $42 B
         fcb   $53 S
         fcb   $2E .
         fcb   $6D m
         fcb   $73 s
         fcb   $67 g
         fcb   $0D 
L0093    fcb   $2A *
         fcb   $2A *
         fcb   $2A *
         fcb   $2A *
         fcb   $2A *
         fcb   $2A *
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $44 D
         fcb   $45 E
         fcb   $4C L
         fcb   $45 E
         fcb   $54 T
         fcb   $45 E
         fcb   $44 D
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $2A *
         fcb   $2A *
         fcb   $2A *
         fcb   $2A *
         fcb   $2A *
         fcb   $2A *
         fcb   $0D 
L00AD    fcb   $4D M
         fcb   $65 e
         fcb   $73 s
         fcb   $73 s
         fcb   $61 a
         fcb   $67 g
         fcb   $65 e
         fcb   $20 
         fcb   $3A :
L00B6    fcb   $46 F
         fcb   $72 r
         fcb   $6F o
         fcb   $6D m
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $3A :
L00BF    fcb   $54 T
         fcb   $6F o
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $3A :
L00C8    fcb   $4C L
         fcb   $65 e
         fcb   $66 f
         fcb   $74 t
         fcb   $20 
         fcb   $6F o
         fcb   $6E n
         fcb   $20 
         fcb   $3A :
L00D1    fcb   $41 A
         fcb   $62 b
         fcb   $6F o
         fcb   $75 u
         fcb   $74 t
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $3A :
L00DA    fcb   $00 
         fcb   $09 
L00DC    fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $0D 
L011D    fcb   $0A 
         fcb   $0A 
         fcb   $0D 
L0120    fcb   $50 P
         fcb   $72 r
         fcb   $65 e
         fcb   $73 s
         fcb   $73 s
         fcb   $20 
         fcb   $3C <
         fcb   $53 S
         fcb   $50 P
         fcb   $41 A
         fcb   $43 C
         fcb   $45 E
         fcb   $3E >
         fcb   $20 
         fcb   $74 t
         fcb   $6F o
         fcb   $20 
         fcb   $73 s
         fcb   $6B k
         fcb   $69 i
         fcb   $70 p
         fcb   $20 
         fcb   $61 a
         fcb   $20 
         fcb   $6D m
         fcb   $65 e
         fcb   $73 s
         fcb   $73 s
         fcb   $61 a
         fcb   $67 g
         fcb   $65 e
         fcb   $0A 
         fcb   $0D 
L0141    fcb   $42 B
         fcb   $42 B
         fcb   $53 S
         fcb   $2E .
         fcb   $6D m
         fcb   $73 s
         fcb   $67 g
         fcb   $2E .
         fcb   $6C l
         fcb   $73 s
         fcb   $74 t
         fcb   $0D 
L014D    fcb   $4E N
         fcb   $6F o
         fcb   $20 
         fcb   $6E n
         fcb   $65 e
         fcb   $77 w
         fcb   $20 
         fcb   $6D m
         fcb   $65 e
         fcb   $73 s
         fcb   $73 s
         fcb   $61 a
         fcb   $67 g
         fcb   $65 e
         fcb   $73 s
         fcb   $20 
         fcb   $74 t
         fcb   $6F o
         fcb   $20 
         fcb   $72 r
         fcb   $65 e
         fcb   $61 a
         fcb   $64 d
         fcb   $2E .
         fcb   $0D 
L0166    fcb   $2F /
         fcb   $64 d
         fcb   $64 d
         fcb   $2F /
         fcb   $62 b
         fcb   $62 b
         fcb   $73 s
         fcb   $2F /
         fcb   $42 B
         fcb   $42 B
         fcb   $53 S
         fcb   $2E .
         fcb   $75 u
         fcb   $73 s
         fcb   $65 e
         fcb   $72 r
         fcb   $73 s
         fcb   $74 t
         fcb   $61 a
         fcb   $74 t
         fcb   $73 s
         fcb   $0D 
L017C    fcb   $2F /
         fcb   $64 d
         fcb   $64 d
         fcb   $2F /
         fcb   $62 b
         fcb   $62 b
         fcb   $73 s
         fcb   $2F /
         fcb   $42 B
         fcb   $42 B
         fcb   $53 S
         fcb   $2E .
         fcb   $61 a
         fcb   $6C l
         fcb   $69 i
         fcb   $61 a
         fcb   $73 s
         fcb   $0D 
L018E    fcb   $55 U
         fcb   $6E n
         fcb   $6B k
         fcb   $6E n
         fcb   $6F o
         fcb   $77 w
         fcb   $6E n
         fcb   $20 
         fcb   $55 U
         fcb   $73 s
         fcb   $65 e
         fcb   $72 r
         fcb   $0D 
L019B    fcb   $41 A
         fcb   $6C l
         fcb   $6C l
         fcb   $20 
         fcb   $55 U
         fcb   $73 s
         fcb   $65 e
         fcb   $72 r
         fcb   $73 s
         fcb   $0D 
start    equ   *
         os9   F$ID     
         sty   u000E,u
         ldy   #$0000
         sty   <u0014,u
         os9   F$SUser  
         leax  >L007F,pcr
         lda   #$01
         os9   I$Open   
         lbcs  L061C
         sta   u0001,u
         leax  >L008B,pcr
         lda   #$01
         os9   I$Open   
         lbcs  L061C
         sta   u0002,u
         leax  >L0141,pcr
         lda   #$03
         os9   I$Open   
         bcc   L01EE
         cmpb  #$D8
         lbne  L061C
         ldb   #$03
         os9   I$Create 
         lbcs  L061C
L01EE    sta   u0003,u
         leax  <u005C,u
         ldy   #$0040
         lda   u0001,u
         os9   I$Read   
         lbcs  L061C
L0200    lda   u0003,u
         leax  <u0010,u
         ldy   #$0004
         os9   I$Read   
         bcs   L0221
         ldd   <u0010,u
         cmpd  u000E,u
         bne   L0200
         ldd   <u0012,u
         addd  #$0001
         std   <u0036,u
         bra   L022D
L0221    cmpb  #$D3
         lbne  L061C
         ldd   #$0001
         std   <u0036,u
L022D    ldd   <u0036,u
         cmpd  <u005C,u
         lbhi  L060E
         clr   <u0049,u
         clr   <u004A,u
         lda   #$06
         sta   u0005,u
         ldd   <u0036,u
L0245    lslb  
         rola  
         rol   <u004A,u
         dec   u0005,u
         bne   L0245
         std   <u004B,u
         ldx   <u0049,u
         lda   u0001,u
         pshs  u
         ldu   <u004B,u
         os9   I$Seek   
         lbcs  L061C
         puls  u
         ldd   <u0036,u
         subd  #$0001
         std   <u0036,u
         lda   u0003,u
         pshs  u
         ldu   #$0000
         tfr   u,x
         os9   I$Seek   
         puls  u
         lbcs  L061C
L027F    lda   u0003,u
         leax  <u0010,u
         ldy   #$0004
         os9   I$Read   
         bcs   L02C6
         ldd   <u0010,u
         cmpd  u000E,u
         bne   L027F
         ldd   <u0012,u
         cmpd  <u005C,u
         bcc   L02E5
         pshs  u
         lda   u0003,u
         ldb   #$05
         os9   I$GetStt 
         lbcs  L061C
         leau  -u0002,u
         os9   I$Seek   
         puls  u
         lbcs  L061C
         leax  <u005C,u
         ldy   #$0002
         os9   I$Write  
         lbcs  L061C
         bra   L02E5
L02C6    cmpb  #$D3
         lbne  L061C
         lda   u0003,u
         leax  u000E,u
         ldy   #$0002
         os9   I$Write  
         lbcs  L061C
         leax  <u005C,u
         os9   I$Write  
         lbcs  L061C
L02E5    lda   u0003,u
         os9   I$Close  
         lbcs  L061C
         leax  >L0120,pcr
         ldy   #$00C8
         lda   #$01
         os9   I$WritLn 
L02FB    lda   u0001,u
         ldy   #$0040
         leax  >u00EC,u
         os9   I$Read   
         lbcs  L055D
         ldd   <u0036,u
         addd  #$0001
         std   <u0036,u
         leax  >L011D,pcr
         ldy   #$0002
         lda   #$01
         os9   I$WritLn 
         ldd   <u0036,u
         leax  <u003C,u
         lbsr  L0686
         leax  >L00AD,pcr
         ldy   >L00DA,pcr
         lda   #$01
         os9   I$Write  
         lbcs  L061C
         leax  <u003C,u
L0340    lda   ,x+
         cmpa  #$20
         beq   L0340
         leax  -$01,x
         ldy   #$0006
         lda   #$01
         os9   I$WritLn 
         lbcs  L061C
         ldd   >u00EC,u
         cmpd  #$FFFF
         lbeq  L04D6
         leax  >L00B6,pcr
         ldy   >L00DA,pcr
         lda   #$01
         os9   I$Write  
         leax  >u00F0,u
         ldy   #$00C8
         lda   #$01
         os9   I$WritLn 
         lbcs  L061C
         leax  >L00BF,pcr
         ldy   >L00DA,pcr
         lda   #$01
         os9   I$Write  
         ldd   >u012A,u
         cmpd  #$FFFF
         beq   L03F8
         leax  >L017C,pcr
         lda   #$01
         os9   I$Open   
         lbcs  L061C
         sta   u0004,u
L03A7    leax  >u012C,u
         ldy   #$00C8
         lda   u0004,u
         os9   I$ReadLn 
         bcs   L03E3
         leax  >u012C,u
L03BA    lda   ,x+
         cmpa  #$2C
         bne   L03BA
         lda   #$0D
         sta   -$01,x
         lbsr  L061F
         cmpd  >u012A,u
         bne   L03A7
         leax  >u012C,u
         ldy   #$00C8
         lda   #$01
         os9   I$WritLn 
         lda   u0004,u
         os9   I$Close  
         lbra  L0405
L03E3    leax  >L018E,pcr
         ldy   #$00C8
         lda   #$01
         os9   I$WritLn 
         lda   u0004,u
         os9   I$Close  
         lbra  L0405
L03F8    leax  >L019B,pcr
         ldy   #$00C8
         lda   #$01
         os9   I$WritLn 
L0405    leax  >L00C8,pcr
         ldy   >L00DA,pcr
         lda   #$01
         os9   I$Write  
         leax  <u003C,u
         ldb   >u0123,u
         clra  
         lbsr  L0686
         lda   <u003F,u
         sta   <u004D,u
         lda   <u0040,u
         sta   <u004E,u
         lda   #$2F
         sta   <u004F,u
         ldb   >u0124,u
         clra  
         leax  <u003C,u
         lbsr  L0686
         lda   <u003F,u
         sta   <u0050,u
         lda   <u0040,u
         sta   <u0051,u
         lda   #$2F
         sta   <u0052,u
         ldb   >u0122,u
         clra  
         leax  <u003C,u
         lbsr  L0686
         lda   <u003F,u
         sta   <u0053,u
         lda   <u0040,u
         sta   <u0054,u
         lda   #$20
         sta   <u0055,u
         ldb   >u0125,u
         clra  
         leax  <u003C,u
         lbsr  L0686
         lda   <u003F,u
         sta   <u0056,u
         lda   <u0040,u
         sta   <u0057,u
         lda   #$3A
         sta   <u0058,u
         ldb   >u0126,u
         clra  
         leax  <u003C,u
         lbsr  L0686
         lda   <u003F,u
         sta   <u0059,u
         lda   <u0040,u
         sta   <u005A,u
         lda   #$0D
         sta   <u005B,u
         leax  <u004D,u
L04A2    lda   ,x+
         cmpa  #$20
         beq   L04A2
         leax  -$01,x
         ldy   #$00C8
         lda   #$01
         os9   I$WritLn 
         lbcs  L061C
         leax  >L00D1,pcr
         ldy   >L00DA,pcr
         lda   #$01
         os9   I$Write  
         leax  >u0104,u
         ldy   #$001E
         os9   I$WritLn 
         lbcs  L061C
         bra   L04E6
L04D6    leax  >L0093,pcr
         ldy   #$00C8
         lda   #$01
         os9   I$WritLn 
         lbra  L02FB
L04E6    leax  >L00DC,pcr
         ldy   #$0050
         lda   #$01
         os9   I$WritLn 
         lda   u0002,u
         ldx   >u00EC,u
         pshs  u
         ldu   >u00EE,u
         os9   I$Seek   
         lbcs  L061C
         puls  u
L0508    clra  
         ldb   #$01
         os9   I$GetStt 
         bcs   L0521
         leax  ,u
         ldy   #$0001
         os9   I$Read   
         lda   ,u
         cmpa  #$20
         lbeq  L02FB
L0521    lda   u0002,u
         leax  >u009C,u
         ldy   #$0050
         os9   I$ReadLn 
         lda   #$01
         os9   I$WritLn 
         cmpy  #$0001
         bhi   L0508
         leax  >L00DC,pcr
         ldy   #$00C8
         lda   #$01
         os9   I$WritLn 
         leax  >L011D,pcr
         ldy   #$0005
         os9   I$WritLn 
         ldd   <u0014,u
         addd  #$0001
         std   <u0014,u
         lbra  L02FB
L055D    leax  >L0166,pcr
         lda   #$03
         os9   I$Open   
         bcc   L0571
         ldb   #$1B
         os9   I$Create 
         lbcs  L061C
L0571    sta   u0007,u
L0573    leax  <u0016,u
         ldy   #$0020
         lda   u0007,u
         os9   I$Read   
         bcs   L058B
         ldd   <u0016,u
         cmpd  u000E,u
         bne   L0573
         bra   L0594
L058B    cmpb  #$D3
         lbne  L061C
         lbra  L05D2
L0594    ldd   <u0022,u
         addd  <u0014,u
         std   <u0022,u
         lda   u0007,u
         ldb   #$05
         pshs  u
         os9   I$GetStt 
         tfr   u,d
         subd  #$0020
         bge   L05AF
         leax  -$01,x
L05AF    ldu   ,s
         tfr   d,y
         lda   u0007,u
         tfr   y,u
         os9   I$Seek   
         lbcs  L061C
         puls  u
         leax  <u0016,u
         ldy   #$0020
         lda   u0007,u
         os9   I$Write  
         os9   I$Close  
         lbra  L061B
L05D2    leax  <u0016,u
         ldd   #$0001
         std   <u0018,u
         std   <u0022,u
         ldd   #$0000
         std   <u0020,u
         std   <u0026,u
         std   <u0024,u
         ldd   u000E,u
         std   <u0016,u
         leax  <u001A,u
         os9   F$Time   
         lbcs  L061C
         leax  <u0016,u
         ldy   #$0020
         lda   u0007,u
         os9   I$Write  
         os9   I$Close  
         lbcs  L061C
         bra   L061B
L060E    leax  >L014D,pcr
         ldy   #$00C8
         lda   #$01
         os9   I$WritLn 
L061B    clrb  
L061C    os9   F$Exit   
L061F    pshs  y
L0621    lda   ,x+
         cmpa  #$0D
         lbeq  L06F4
         cmpa  #$30
         bcs   L0621
         cmpa  #$39
         bhi   L0621
         leax  -$01,x
L0633    lda   ,x+
         cmpa  #$30
         bcs   L063F
         cmpa  #$39
         bhi   L063F
         bra   L0633
L063F    pshs  x
         leax  -$01,x
         clr   u000A,u
         clr   u000B,u
         ldd   #$0001
         std   u000C,u
L064C    lda   ,-x
         cmpa  #$30
         bcs   L0680
         cmpa  #$39
         bhi   L0680
         suba  #$30
         sta   u0006,u
         ldd   #$0000
L065D    tst   u0006,u
         beq   L0667
         addd  u000C,u
         dec   u0006,u
         bra   L065D
L0667    addd  u000A,u
         std   u000A,u
         lda   #$0A
         sta   u0006,u
         ldd   #$0000
L0672    tst   u0006,u
         beq   L067C
         addd  u000C,u
         dec   u0006,u
         bra   L0672
L067C    std   u000C,u
         bra   L064C
L0680    ldd   u000A,u
         puls  x
         puls  pc,y
L0686    pshs  x
         std   u000A,u
         lda   #$30
         sta   ,x
         sta   $01,x
         sta   $02,x
         sta   $03,x
         sta   $04,x
         ldd   #$2710
         std   u000C,u
         ldd   u000A,u
         lbsr  L06E5
         ldd   #$03E8
         std   u000C,u
         ldd   u000A,u
         bsr   L06E5
         ldd   #$0064
         std   u000C,u
         ldd   u000A,u
         bsr   L06E5
         ldd   #$000A
         std   u000C,u
         ldd   u000A,u
         bsr   L06E5
         ldd   #$0001
         std   u000C,u
         ldd   u000A,u
         bsr   L06E5
         lda   #$0D
         sta   ,x
         puls  x
         ldb   #$20
L06CC    lda   ,x
         cmpa  #$30
         bne   L06D6
         stb   ,x+
         bra   L06CC
L06D6    lda   ,x+
         cmpa  #$30
         bcs   L06E2
         cmpa  #$39
         bhi   L06E2
         bra   L06D6
L06E2    leax  -$01,x
         rts   
L06E5    subd  u000C,u
         bcs   L06ED
         inc   ,x
         bra   L06E5
L06ED    addd  u000C,u
         std   u000A,u
         leax  $01,x
         rts   
L06F4    ldd   #$FFFF
         puls  pc,y
         emod
eom      equ   *
         end
