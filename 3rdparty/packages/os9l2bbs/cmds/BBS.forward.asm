         nam   BBS.forward
         ttl   program module       

* Disassembled 2010/01/24 10:31:56 by Disasm v1.5 (C) 1988 by RML

         ifp1
         use   /dd/defs/defsfile
         endc
tylg     set   Prgrm+Objct   
atrv     set   ReEnt+rev
rev      set   $01
         mod   eom,name,tylg,atrv,start,size
u0000    rmb   1
u0001    rmb   1
u0002    rmb   1
u0003    rmb   1
u0004    rmb   1
u0005    rmb   1
u0006    rmb   1
u0007    rmb   1
u0008    rmb   2
u000A    rmb   2
u000C    rmb   2
u000E    rmb   2
u0010    rmb   6
u0016    rmb   2
u0018    rmb   2
u001A    rmb   2
u001C    rmb   18
u002E    rmb   1
u002F    rmb   1
u0030    rmb   2
u0032    rmb   2
u0034    rmb   2
u0036    rmb   6
u003C    rmb   3
u003F    rmb   1
u0040    rmb   2
u0042    rmb   1
u0043    rmb   6
u0049    rmb   1
u004A    rmb   1
u004B    rmb   2
u004D    rmb   1
u004E    rmb   1
u004F    rmb   1
u0050    rmb   1
u0051    rmb   1
u0052    rmb   1
u0053    rmb   1
u0054    rmb   1
u0055    rmb   1
u0056    rmb   1
u0057    rmb   1
u0058    rmb   1
u0059    rmb   1
u005A    rmb   1
u005B    rmb   1
u005C    rmb   64
u009C    rmb   80
u00EC    rmb   2
u00EE    rmb   2
u00F0    rmb   20
u0104    rmb   30
u0122    rmb   1
u0123    rmb   1
u0124    rmb   1
u0125    rmb   1
u0126    rmb   4
u012A    rmb   2
u012C    rmb   400
size     equ   .
name     equ   *
         fcs   /BBS.forward/
         fcb   $43 C
         fcb   $6F o
         fcb   $70 p
         fcb   $79 y
         fcb   $72 r
         fcb   $69 i
         fcb   $67 g
         fcb   $68 h
         fcb   $74 t
         fcb   $20 
         fcb   $28 (
         fcb   $43 C
         fcb   $29 )
         fcb   $20 
         fcb   $31 1
         fcb   $39 9
         fcb   $38 8
         fcb   $38 8
         fcb   $42 B
         fcb   $79 y
         fcb   $20 
         fcb   $4B K
         fcb   $65 e
         fcb   $69 i
         fcb   $74 t
         fcb   $68 h
         fcb   $20 
         fcb   $41 A
         fcb   $6C l
         fcb   $70 p
         fcb   $68 h
         fcb   $6F o
         fcb   $6E n
         fcb   $73 s
         fcb   $6F o
         fcb   $4C L
         fcb   $69 i
         fcb   $63 c
         fcb   $65 e
         fcb   $6E n
         fcb   $63 c
         fcb   $65 e
         fcb   $64 d
         fcb   $20 
         fcb   $74 t
         fcb   $6F o
         fcb   $20 
         fcb   $41 A
         fcb   $6C l
         fcb   $70 p
         fcb   $68 h
         fcb   $61 a
         fcb   $20 
         fcb   $53 S
         fcb   $6F o
         fcb   $66 f
         fcb   $74 t
         fcb   $77 w
         fcb   $61 a
         fcb   $72 r
         fcb   $65 e
         fcb   $20 
         fcb   $54 T
         fcb   $65 e
         fcb   $63 c
         fcb   $68 h
         fcb   $6E n
         fcb   $6F o
         fcb   $6C l
         fcb   $6F o
         fcb   $67 g
         fcb   $69 i
         fcb   $65 e
         fcb   $73 s
         fcb   $41 A
         fcb   $6C l
         fcb   $6C l
         fcb   $20 
         fcb   $72 r
         fcb   $69 i
         fcb   $67 g
         fcb   $68 h
         fcb   $74 t
         fcb   $73 s
         fcb   $20 
         fcb   $72 r
         fcb   $65 e
         fcb   $73 s
         fcb   $65 e
         fcb   $72 r
         fcb   $76 v
         fcb   $65 e
         fcb   $64 d
         fcb   $EC l
         fcb   $E6 f
         fcb   $EA j
         fcb   $F5 u
         fcb   $E9 i
         fcb   $A0 
         fcb   $E2 b
         fcb   $ED m
         fcb   $F1 q
         fcb   $E9 i
         fcb   $F0 p
         fcb   $EF o
         fcb   $F4 t
         fcb   $F0 p
L0083    fcb   $48 H
         fcb   $69 i
         fcb   $67 g
         fcb   $68 h
         fcb   $20 
         fcb   $6D m
         fcb   $65 e
         fcb   $73 s
         fcb   $73 s
         fcb   $61 a
         fcb   $67 g
         fcb   $65 e
         fcb   $20 
         fcb   $69 i
         fcb   $73 s
         fcb   $20 
         fcb   $23 #
L0094    fcb   $00 
         fcb   $11 
L0096    fcb   $45 E
         fcb   $6E n
         fcb   $74 t
         fcb   $65 e
         fcb   $72 r
         fcb   $20 
         fcb   $73 s
         fcb   $74 t
         fcb   $61 a
         fcb   $72 r
         fcb   $74 t
         fcb   $69 i
         fcb   $6E n
         fcb   $67 g
         fcb   $20 
         fcb   $6D m
         fcb   $65 e
         fcb   $73 s
         fcb   $73 s
         fcb   $61 a
         fcb   $67 g
         fcb   $65 e
         fcb   $20 
         fcb   $23 #
         fcb   $0D 
L00AF    fcb   $3E >
L00B0    fcb   $42 B
         fcb   $42 B
         fcb   $53 S
         fcb   $2E .
         fcb   $6D m
         fcb   $73 s
         fcb   $67 g
         fcb   $2E .
         fcb   $69 i
         fcb   $6E n
         fcb   $78 x
         fcb   $0D 
L00BC    fcb   $42 B
         fcb   $42 B
         fcb   $53 S
         fcb   $2E .
         fcb   $6D m
         fcb   $73 s
         fcb   $67 g
         fcb   $0D 
L00C4    fcb   $2A *
         fcb   $2A *
         fcb   $2A *
         fcb   $2A *
         fcb   $2A *
         fcb   $2A *
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $44 D
         fcb   $45 E
         fcb   $4C L
         fcb   $45 E
         fcb   $54 T
         fcb   $45 E
         fcb   $44 D
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $2A *
         fcb   $2A *
         fcb   $2A *
         fcb   $2A *
         fcb   $2A *
         fcb   $2A *
         fcb   $0D 
L00DE    fcb   $4D M
         fcb   $65 e
         fcb   $73 s
         fcb   $73 s
         fcb   $61 a
         fcb   $67 g
         fcb   $65 e
         fcb   $20 
         fcb   $3A :
L00E7    fcb   $46 F
         fcb   $72 r
         fcb   $6F o
         fcb   $6D m
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $3A :
L00F0    fcb   $54 T
         fcb   $6F o
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $3A :
L00F9    fcb   $4C L
         fcb   $65 e
         fcb   $66 f
         fcb   $74 t
         fcb   $20 
         fcb   $6F o
         fcb   $6E n
         fcb   $20 
         fcb   $3A :
L0102    fcb   $41 A
         fcb   $62 b
         fcb   $6F o
         fcb   $75 u
         fcb   $74 t
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $3A :
L010B    fcb   $00 
         fcb   $09 
L010D    fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $0D 
L014E    fcb   $0A 
         fcb   $0A 
         fcb   $0D 
L0151    fcb   $50 P
         fcb   $72 r
         fcb   $65 e
         fcb   $73 s
         fcb   $73 s
         fcb   $20 
         fcb   $3C <
         fcb   $53 S
         fcb   $50 P
         fcb   $41 A
         fcb   $43 C
         fcb   $45 E
         fcb   $3E >
         fcb   $20 
         fcb   $74 t
         fcb   $6F o
         fcb   $20 
         fcb   $73 s
         fcb   $6B k
         fcb   $69 i
         fcb   $70 p
         fcb   $20 
         fcb   $61 a
         fcb   $20 
         fcb   $6D m
         fcb   $65 e
         fcb   $73 s
         fcb   $73 s
         fcb   $61 a
         fcb   $67 g
         fcb   $65 e
         fcb   $0A 
         fcb   $0D 
L0172    fcb   $42 B
         fcb   $42 B
         fcb   $53 S
         fcb   $2E .
         fcb   $6D m
         fcb   $73 s
         fcb   $67 g
         fcb   $2E .
         fcb   $6C l
         fcb   $73 s
         fcb   $74 t
         fcb   $0D 
L017E    fcb   $2F /
         fcb   $64 d
         fcb   $64 d
         fcb   $2F /
         fcb   $62 b
         fcb   $62 b
         fcb   $73 s
         fcb   $2F /
         fcb   $42 B
         fcb   $42 B
         fcb   $53 S
         fcb   $2E .
         fcb   $75 u
         fcb   $73 s
         fcb   $65 e
         fcb   $72 r
         fcb   $73 s
         fcb   $74 t
         fcb   $61 a
         fcb   $74 t
         fcb   $73 s
         fcb   $0D 
L0194    fcb   $2F /
         fcb   $64 d
         fcb   $64 d
         fcb   $2F /
         fcb   $62 b
         fcb   $62 b
         fcb   $73 s
         fcb   $2F /
         fcb   $42 B
         fcb   $42 B
         fcb   $53 S
         fcb   $2E .
         fcb   $61 a
         fcb   $6C l
         fcb   $69 i
         fcb   $61 a
         fcb   $73 s
         fcb   $0D 
L01A6    fcb   $55 U
         fcb   $6E n
         fcb   $6B k
         fcb   $6E n
         fcb   $6F o
         fcb   $77 w
         fcb   $6E n
         fcb   $20 
         fcb   $55 U
         fcb   $73 s
         fcb   $65 e
         fcb   $72 r
         fcb   $0D 
L01B3    fcb   $41 A
         fcb   $6C l
         fcb   $6C l
         fcb   $20 
         fcb   $55 U
         fcb   $73 s
         fcb   $65 e
         fcb   $72 r
         fcb   $73 s
         fcb   $0D 
start    equ   *
         os9   F$ID     
         sty   u000A,u
         ldd   #$0000
         std   u0008,u
         ldy   #$0000
         os9   F$SUser  
         leax  >L00B0,pcr
         lda   #$01
         os9   I$Open   
         lbcs  L062E
         sta   u0001,u
         leax  >L0172,pcr
         lda   #$03
         os9   I$Open   
         bcc   L01F8
         cmpb  #$D8
         lbne  L062E
         ldb   #$0B
         os9   I$Create 
         lbcs  L062E
L01F8    sta   u0003,u
         leax  >L00BC,pcr
         lda   #$01
         os9   I$Open   
         lbcs  L062E
         sta   u0002,u
         leax  <u005C,u
         ldy   #$0040
         lda   u0001,u
         os9   I$Read   
         lbcs  L062E
         ldd   <u005C,u
         leax  <u0036,u
         lbsr  L06A1
         leax  >L0083,pcr
         ldy   >L0094,pcr
         lda   #$01
         os9   I$Write  
         lbcs  L062E
         leax  <u0036,u
         ldy   #$0006
         os9   I$WritLn 
         lbcs  L062E
         leax  >L0096,pcr
         ldy   #$00C8
         lda   #$01
         os9   I$WritLn 
         lbcs  L062E
         leax  >L00AF,pcr
         ldy   #$0001
         os9   I$Write  
         lbcs  L062E
         leax  <u0043,u
         ldy   #$0006
         clra  
         os9   I$ReadLn 
         lbcs  L062E
         clr   <u0042,u
         leax  <u0043,u
         lbsr  L0631
         cmpd  #$0001
         lbcs  L062D
         cmpd  <u005C,u
         lbhi  L062D
         std   <u0036,u
         clr   <u0049,u
         clr   <u004A,u
         lda   #$06
         sta   u0005,u
         ldd   <u0036,u
L029A    lslb  
         rola  
         rol   <u004A,u
         dec   u0005,u
         bne   L029A
         std   <u004B,u
         ldx   <u0049,u
         lda   u0001,u
         pshs  u
         ldu   <u004B,u
         os9   I$Seek   
         lbcs  L062E
         puls  u
         ldd   <u0036,u
         subd  #$0001
         std   <u0036,u
L02C2    lda   u0003,u
         leax  <u0032,u
         ldy   #$0004
         os9   I$Read   
         bcs   L02FD
         ldd   <u0032,u
         cmpd  u000A,u
         bne   L02C2
         ldd   <u0034,u
         cmpd  <u005C,u
         bcc   L0314
         pshs  u
         lda   u0003,u
         ldb   #$05
         os9   I$GetStt 
         leau  -u0002,u
         os9   I$Seek   
         puls  u
         leax  <u005C,u
         ldy   #$0002
         os9   I$Write  
         bra   L0314
L02FD    cmpb  #$D3
         lbne  L062E
         lda   u0003,u
         leax  u000A,u
         ldy   #$0002
         os9   I$Write  
         leax  <u005C,u
         os9   I$Write  
L0314    lda   u0003,u
         os9   I$Close  
         leax  >L0151,pcr
         ldy   #$00C8
         lda   #$01
         os9   I$WritLn 
L0326    lda   u0001,u
         ldy   #$0040
         leax  >u00EC,u
         os9   I$Read   
         lbcs  L0586
         ldd   <u0036,u
         addd  #$0001
         std   <u0036,u
         leax  >L014E,pcr
         ldy   #$0002
         lda   #$01
         os9   I$WritLn 
         ldd   <u0036,u
         leax  <u003C,u
         lbsr  L06A1
         leax  >L00DE,pcr
         ldy   >L010B,pcr
         lda   #$01
         os9   I$Write  
         lbcs  L062E
         leax  <u003C,u
L036B    lda   ,x+
         cmpa  #$20
         beq   L036B
         leax  -$01,x
         ldy   #$0006
         lda   #$01
         os9   I$WritLn 
         lbcs  L062E
         ldd   >u00EC,u
         cmpd  #$FFFF
         lbeq  L0501
         leax  >L00E7,pcr
         ldy   >L010B,pcr
         lda   #$01
         os9   I$Write  
         leax  >u00F0,u
         ldy   #$00C8
         lda   #$01
         os9   I$WritLn 
         lbcs  L062E
         leax  >L00F0,pcr
         ldy   >L010B,pcr
         lda   #$01
         os9   I$Write  
         ldd   >u012A,u
         cmpd  #$FFFF
         beq   L0423
         leax  >L0194,pcr
         lda   #$01
         os9   I$Open   
         lbcs  L062E
         sta   u0004,u
L03D2    leax  >u012C,u
         ldy   #$00C8
         lda   u0004,u
         os9   I$ReadLn 
         bcs   L040E
         leax  >u012C,u
L03E5    lda   ,x+
         cmpa  #$2C
         bne   L03E5
         lda   #$0D
         sta   -$01,x
         lbsr  L0631
         cmpd  >u012A,u
         bne   L03D2
         leax  >u012C,u
         ldy   #$00C8
         lda   #$01
         os9   I$WritLn 
         lda   u0004,u
         os9   I$Close  
         lbra  L0430
L040E    leax  >L01A6,pcr
         ldy   #$00C8
         lda   #$01
         os9   I$WritLn 
         lda   u0004,u
         os9   I$Close  
         lbra  L0430
L0423    leax  >L01B3,pcr
         ldy   #$00C8
         lda   #$01
         os9   I$WritLn 
L0430    leax  >L00F9,pcr
         ldy   >L010B,pcr
         lda   #$01
         os9   I$Write  
         leax  <u003C,u
         ldb   >u0123,u
         clra  
         lbsr  L06A1
         lda   <u003F,u
         sta   <u004D,u
         lda   <u0040,u
         sta   <u004E,u
         lda   #$2F
         sta   <u004F,u
         ldb   >u0124,u
         clra  
         leax  <u003C,u
         lbsr  L06A1
         lda   <u003F,u
         sta   <u0050,u
         lda   <u0040,u
         sta   <u0051,u
         lda   #$2F
         sta   <u0052,u
         ldb   >u0122,u
         clra  
         leax  <u003C,u
         lbsr  L06A1
         lda   <u003F,u
         sta   <u0053,u
         lda   <u0040,u
         sta   <u0054,u
         lda   #$20
         sta   <u0055,u
         ldb   >u0125,u
         clra  
         leax  <u003C,u
         lbsr  L06A1
         lda   <u003F,u
         sta   <u0056,u
         lda   <u0040,u
         sta   <u0057,u
         lda   #$3A
         sta   <u0058,u
         ldb   >u0126,u
         clra  
         leax  <u003C,u
         lbsr  L06A1
         lda   <u003F,u
         sta   <u0059,u
         lda   <u0040,u
         sta   <u005A,u
         lda   #$0D
         sta   <u005B,u
         leax  <u004D,u
L04CD    lda   ,x+
         cmpa  #$20
         beq   L04CD
         leax  -$01,x
         ldy   #$00C8
         lda   #$01
         os9   I$WritLn 
         lbcs  L062E
         leax  >L0102,pcr
         ldy   >L010B,pcr
         lda   #$01
         os9   I$Write  
         leax  >u0104,u
         ldy   #$001E
         os9   I$WritLn 
         lbcs  L062E
         bra   L0511
L0501    leax  >L00C4,pcr
         ldy   #$00C8
         lda   #$01
         os9   I$WritLn 
         lbra  L0326
L0511    leax  >L010D,pcr
         ldy   #$0050
         lda   #$01
         os9   I$WritLn 
         lda   u0002,u
         ldx   >u00EC,u
         pshs  u
         ldu   >u00EE,u
         os9   I$Seek   
         lbcs  L062E
         puls  u
L0533    clra  
         ldb   #$01
         os9   I$GetStt 
         bcs   L054C
         leax  ,u
         ldy   #$0001
         os9   I$Read   
         lda   ,u
         cmpa  #$20
         lbeq  L0326
L054C    lda   u0002,u
         leax  >u009C,u
         ldy   #$0050
         os9   I$ReadLn 
         lda   #$01
         os9   I$WritLn 
         cmpy  #$0001
         bhi   L0533
         leax  >L010D,pcr
         ldy   #$00C8
         lda   #$01
         os9   I$WritLn 
         leax  >L014E,pcr
         ldy   #$0005
         os9   I$WritLn 
         ldd   u0008,u
         addd  #$0001
         std   u0008,u
         lbra  L0326
L0586    leax  >L017E,pcr
         lda   #$03
         os9   I$Open   
         bcc   L059A
         ldb   #$1B
         os9   I$Create 
         lbcs  L062E
L059A    sta   u0007,u
L059C    leax  u000C,u
         ldy   #$0020
         lda   u0007,u
         os9   I$Read   
         bcs   L05B2
         ldd   u000C,u
         cmpd  u000A,u
         bne   L059C
         bra   L05BB
L05B2    cmpb  #$D3
         lbne  L062E
         lbra  L05F7
L05BB    ldd   <u0018,u
         addd  u0008,u
         std   <u0018,u
         lda   u0007,u
         ldb   #$05
         pshs  u
         os9   I$GetStt 
         tfr   u,d
         subd  #$0020
         bge   L05D5
         leax  -$01,x
L05D5    ldu   ,s
         tfr   d,y
         lda   u0007,u
         tfr   y,u
         os9   I$Seek   
         lbcs  L062E
         puls  u
         leax  u000C,u
         ldy   #$0020
         lda   u0007,u
         os9   I$Write  
         os9   I$Close  
         lbra  L062D
L05F7    leax  u000C,u
         ldd   #$0001
         std   u000E,u
         std   <u0018,u
         ldd   #$0000
         std   <u0016,u
         std   <u001C,u
         std   <u001A,u
         ldd   u000A,u
         std   u000C,u
         leax  <u0010,u
         os9   F$Time   
         lbcs  L062E
         leax  u000C,u
         ldy   #$0020
         lda   u0007,u
         os9   I$Write  
         os9   I$Close  
         lbcs  L062E
L062D    clrb  
L062E    os9   F$Exit   
L0631    pshs  y
L0633    lda   ,x+
         cmpa  #$0D
         lbeq  L071D
         cmpa  #$30
         bcs   L0633
         cmpa  #$39
         bhi   L0633
         leax  -$01,x
L0645    lda   ,x+
         cmpa  #$30
         bcs   L0651
         cmpa  #$39
         bhi   L0651
         bra   L0645
L0651    pshs  x
         leax  -$01,x
         clr   <u002E,u
         clr   <u002F,u
         ldd   #$0001
         std   <u0030,u
L0661    lda   ,-x
         cmpa  #$30
         bcs   L069A
         cmpa  #$39
         bhi   L069A
         suba  #$30
         sta   u0006,u
         ldd   #$0000
L0672    tst   u0006,u
         beq   L067D
         addd  <u0030,u
         dec   u0006,u
         bra   L0672
L067D    addd  <u002E,u
         std   <u002E,u
         lda   #$0A
         sta   u0006,u
         ldd   #$0000
L068A    tst   u0006,u
         beq   L0695
         addd  <u0030,u
         dec   u0006,u
         bra   L068A
L0695    std   <u0030,u
         bra   L0661
L069A    ldd   <u002E,u
         puls  x
         puls  pc,y
L06A1    pshs  x
         std   <u002E,u
         lda   #$30
         sta   ,x
         sta   $01,x
         sta   $02,x
         sta   $03,x
         sta   $04,x
         ldd   #$2710
         std   <u0030,u
         ldd   <u002E,u
         lbsr  L070B
         ldd   #$03E8
         std   <u0030,u
         ldd   <u002E,u
         bsr   L070B
         ldd   #$0064
         std   <u0030,u
         ldd   <u002E,u
         bsr   L070B
         ldd   #$000A
         std   <u0030,u
         ldd   <u002E,u
         bsr   L070B
         ldd   #$0001
         std   <u0030,u
         ldd   <u002E,u
         bsr   L070B
         lda   #$0D
         sta   ,x
         puls  x
         ldb   #$20
L06F2    lda   ,x
         cmpa  #$30
         bne   L06FC
         stb   ,x+
         bra   L06F2
L06FC    lda   ,x+
         cmpa  #$30
         bcs   L0708
         cmpa  #$39
         bhi   L0708
         bra   L06FC
L0708    leax  -$01,x
         rts   
L070B    subd  <u0030,u
         bcs   L0714
         inc   ,x
         bra   L070B
L0714    addd  <u0030,u
         std   <u002E,u
         leax  $01,x
         rts   
L071D    ldd   #$FFFF
         puls  pc,y
         emod
eom      equ   *
         end
