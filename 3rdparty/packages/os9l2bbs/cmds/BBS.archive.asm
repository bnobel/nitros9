         nam   BBS.archive
         ttl   program module       

* Disassembled 2010/01/24 10:54:38 by Disasm v1.5 (C) 1988 by RML

         ifp1
         use   /dd/defs/defsfile
         endc
tylg     set   Prgrm+Objct   
atrv     set   ReEnt+rev
rev      set   $01
         mod   eom,name,tylg,atrv,start,size
u0000    rmb   1
u0001    rmb   1
u0002    rmb   1
u0003    rmb   1
u0004    rmb   2
u0006    rmb   2
u0008    rmb   2
u000A    rmb   2
u000C    rmb   36
u0030    rmb   1
u0031    rmb   1
u0032    rmb   6
u0038    rmb   6
u003E    rmb   3
u0041    rmb   1
u0042    rmb   2
u0044    rmb   1
u0045    rmb   10
u004F    rmb   1
u0050    rmb   1
u0051    rmb   1
u0052    rmb   1
u0053    rmb   1
u0054    rmb   1
u0055    rmb   1
u0056    rmb   1
u0057    rmb   1
u0058    rmb   1
u0059    rmb   1
u005A    rmb   1
u005B    rmb   1
u005C    rmb   1
u005D    rmb   1
u005E    rmb   64
u009E    rmb   80
u00EE    rmb   2
u00F0    rmb   2
u00F2    rmb   20
u0106    rmb   30
u0124    rmb   1
u0125    rmb   1
u0126    rmb   1
u0127    rmb   1
u0128    rmb   4
u012C    rmb   2
u012E    rmb   200
u01F6    rmb   400
size     equ   .
name     equ   *
         fcs   /BBS.archive/
         fcb   $43 C
         fcb   $6F o
         fcb   $70 p
         fcb   $79 y
         fcb   $72 r
         fcb   $69 i
         fcb   $67 g
         fcb   $68 h
         fcb   $74 t
         fcb   $20 
         fcb   $28 (
         fcb   $43 C
         fcb   $29 )
         fcb   $20 
         fcb   $31 1
         fcb   $39 9
         fcb   $38 8
         fcb   $38 8
         fcb   $42 B
         fcb   $79 y
         fcb   $20 
         fcb   $4B K
         fcb   $65 e
         fcb   $69 i
         fcb   $74 t
         fcb   $68 h
         fcb   $20 
         fcb   $41 A
         fcb   $6C l
         fcb   $70 p
         fcb   $68 h
         fcb   $6F o
         fcb   $6E n
         fcb   $73 s
         fcb   $6F o
         fcb   $4C L
         fcb   $69 i
         fcb   $63 c
         fcb   $65 e
         fcb   $6E n
         fcb   $63 c
         fcb   $65 e
         fcb   $64 d
         fcb   $20 
         fcb   $74 t
         fcb   $6F o
         fcb   $20 
         fcb   $41 A
         fcb   $6C l
         fcb   $70 p
         fcb   $68 h
         fcb   $61 a
         fcb   $20 
         fcb   $53 S
         fcb   $6F o
         fcb   $66 f
         fcb   $74 t
         fcb   $77 w
         fcb   $61 a
         fcb   $72 r
         fcb   $65 e
         fcb   $20 
         fcb   $54 T
         fcb   $65 e
         fcb   $63 c
         fcb   $68 h
         fcb   $6E n
         fcb   $6F o
         fcb   $6C l
         fcb   $6F o
         fcb   $67 g
         fcb   $69 i
         fcb   $65 e
         fcb   $73 s
         fcb   $41 A
         fcb   $6C l
         fcb   $6C l
         fcb   $20 
         fcb   $72 r
         fcb   $69 i
         fcb   $67 g
         fcb   $68 h
         fcb   $74 t
         fcb   $73 s
         fcb   $20 
         fcb   $72 r
         fcb   $65 e
         fcb   $73 s
         fcb   $65 e
         fcb   $72 r
         fcb   $76 v
         fcb   $65 e
         fcb   $64 d
         fcb   $EC l
         fcb   $E6 f
         fcb   $EA j
         fcb   $F5 u
         fcb   $E9 i
         fcb   $A0 
         fcb   $E2 b
         fcb   $ED m
         fcb   $F1 q
         fcb   $E9 i
         fcb   $F0 p
         fcb   $EF o
         fcb   $F4 t
         fcb   $F0 p
L0083    fcb   $48 H
         fcb   $69 i
         fcb   $67 g
         fcb   $68 h
         fcb   $20 
         fcb   $6D m
         fcb   $65 e
         fcb   $73 s
         fcb   $73 s
         fcb   $61 a
         fcb   $67 g
         fcb   $65 e
         fcb   $20 
         fcb   $69 i
         fcb   $73 s
         fcb   $20 
         fcb   $23 #
L0094    fcb   $00 
         fcb   $11 
L0096    fcb   $45 E
         fcb   $6E n
         fcb   $74 t
         fcb   $65 e
         fcb   $72 r
         fcb   $20 
         fcb   $6E n
         fcb   $65 e
         fcb   $77 w
         fcb   $20 
         fcb   $68 h
         fcb   $69 i
         fcb   $67 g
         fcb   $68 h
         fcb   $20 
         fcb   $6D m
         fcb   $65 e
         fcb   $73 s
         fcb   $73 s
         fcb   $61 a
         fcb   $67 g
         fcb   $65 e
         fcb   $20 
         fcb   $23 #
         fcb   $0D 
L00AF    fcb   $45 E
         fcb   $6E n
         fcb   $74 t
         fcb   $65 e
         fcb   $72 r
         fcb   $20 
         fcb   $6F o
         fcb   $75 u
         fcb   $74 t
         fcb   $70 p
         fcb   $75 u
         fcb   $74 t
         fcb   $20 
         fcb   $66 f
         fcb   $69 i
         fcb   $6C l
         fcb   $65 e
         fcb   $6E n
         fcb   $61 a
         fcb   $6D m
         fcb   $65 e
         fcb   $20 
         fcb   $28 (
         fcb   $42 B
         fcb   $4C L
         fcb   $41 A
         fcb   $4E N
         fcb   $4B K
         fcb   $20 
         fcb   $3D =
         fcb   $20 
         fcb   $6E n
         fcb   $6F o
         fcb   $6E n
         fcb   $65 e
         fcb   $29 )
         fcb   $0D 
L00D4    fcb   $3E >
L00D5    fcb   $42 B
         fcb   $42 B
         fcb   $53 S
         fcb   $2E .
         fcb   $6D m
         fcb   $73 s
         fcb   $67 g
         fcb   $2E .
         fcb   $69 i
         fcb   $6E n
         fcb   $78 x
         fcb   $0D 
L00E1    fcb   $42 B
         fcb   $42 B
         fcb   $53 S
         fcb   $2E .
         fcb   $6D m
         fcb   $73 s
         fcb   $67 g
         fcb   $0D 
L00E9    fcb   $42 B
         fcb   $42 B
         fcb   $53 S
         fcb   $2E .
         fcb   $70 p
         fcb   $61 a
         fcb   $63 c
         fcb   $6B k
         fcb   $0D 
         fcb   $2A *
         fcb   $2A *
         fcb   $2A *
         fcb   $2A *
         fcb   $2A *
         fcb   $2A *
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $44 D
         fcb   $45 E
         fcb   $4C L
         fcb   $45 E
         fcb   $54 T
         fcb   $45 E
         fcb   $44 D
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $2A *
         fcb   $2A *
         fcb   $2A *
         fcb   $2A *
         fcb   $2A *
         fcb   $2A *
         fcb   $0D 
         fcb   $4D M
         fcb   $65 e
         fcb   $73 s
         fcb   $73 s
         fcb   $61 a
         fcb   $67 g
         fcb   $65 e
         fcb   $20 
         fcb   $3A :
L0115    fcb   $46 F
         fcb   $72 r
         fcb   $6F o
         fcb   $6D m
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $3A :
L011E    fcb   $54 T
         fcb   $6F o
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $3A :
L0127    fcb   $4C L
         fcb   $65 e
         fcb   $66 f
         fcb   $74 t
         fcb   $20 
         fcb   $6F o
         fcb   $6E n
         fcb   $20 
         fcb   $3A :
L0130    fcb   $41 A
         fcb   $62 b
         fcb   $6F o
         fcb   $75 u
         fcb   $74 t
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $3A :
L0139    fcb   $00 
         fcb   $09 
L013B    fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $0D 
L017C    fcb   $0A 
         fcb   $0A 
L017E    fcb   $0D 
         fcb   $42 B
         fcb   $42 B
         fcb   $53 S
         fcb   $2E .
         fcb   $6D m
         fcb   $73 s
         fcb   $67 g
         fcb   $2E .
         fcb   $6C l
         fcb   $73 s
         fcb   $74 t
         fcb   $0D 
         fcb   $2F /
         fcb   $64 d
         fcb   $64 d
         fcb   $2F /
         fcb   $62 b
         fcb   $62 b
         fcb   $73 s
         fcb   $2F /
         fcb   $42 B
         fcb   $42 B
         fcb   $53 S
         fcb   $2E .
         fcb   $75 u
         fcb   $73 s
         fcb   $65 e
         fcb   $72 r
         fcb   $73 s
         fcb   $74 t
         fcb   $61 a
         fcb   $74 t
         fcb   $73 s
         fcb   $0D 
L01A1    fcb   $2F /
         fcb   $64 d
         fcb   $64 d
         fcb   $2F /
         fcb   $62 b
         fcb   $62 b
         fcb   $73 s
         fcb   $2F /
         fcb   $42 B
         fcb   $42 B
         fcb   $53 S
         fcb   $2E .
         fcb   $61 a
         fcb   $6C l
         fcb   $69 i
         fcb   $61 a
         fcb   $73 s
         fcb   $0D 
L01B3    fcb   $55 U
         fcb   $6E n
         fcb   $6B k
         fcb   $6E n
         fcb   $6F o
         fcb   $77 w
         fcb   $6E n
         fcb   $20 
         fcb   $55 U
         fcb   $73 s
         fcb   $65 e
         fcb   $72 r
         fcb   $0D 
L01C0    fcb   $41 A
         fcb   $6C l
         fcb   $6C l
         fcb   $20 
         fcb   $55 U
         fcb   $73 s
         fcb   $65 e
         fcb   $72 r
         fcb   $73 s
         fcb   $0D 
L01CA    fcb   $FF 
         fcb   $FF 
L01CC    fcb   $53 S
         fcb   $61 a
         fcb   $76 v
         fcb   $69 i
         fcb   $6E n
         fcb   $67 g
         fcb   $20 
         fcb   $4D M
         fcb   $65 e
         fcb   $73 s
         fcb   $73 s
         fcb   $61 a
         fcb   $67 g
         fcb   $65 e
         fcb   $73 s
         fcb   $2E .
         fcb   $2E .
         fcb   $2E .
         fcb   $0D 
start    equ   *
         os9   F$ID     
         ldb   #$D6
         cmpy  #$0000
         lbne  L057A
         sty   u000C,u
         ldd   #$0000
         std   u000A,u
         leax  >L00D5,pcr
         lda   #$03
         os9   I$Open   
         lbcs  L057A
         sta   u0001,u
         leax  >L00E1,pcr
         lda   #$01
         os9   I$Open   
         lbcs  L057A
         sta   u0002,u
         leax  <u005E,u
         ldy   #$0040
         lda   u0001,u
         os9   I$Read   
         lbcs  L057A
         ldd   <u005E,u
         leax  <u0038,u
         lbsr  L05ED
         leax  >L0083,pcr
         ldy   >L0094,pcr
         lda   #$01
         os9   I$Write  
         lbcs  L057A
         leax  <u0038,u
         ldy   #$0006
         os9   I$WritLn 
         lbcs  L057A
         ldd   #$0000
         std   <u0038,u
         leax  >L0096,pcr
         ldy   #$00C8
         lda   #$01
         os9   I$WritLn 
         lbcs  L057A
         leax  >L00D4,pcr
         ldy   #$0001
         os9   I$Write  
         lbcs  L057A
         leax  <u0045,u
         ldy   #$0006
         clra  
         os9   I$ReadLn 
         lbcs  L057A
         clr   <u0044,u
         leax  <u0045,u
         lbsr  L057D
         cmpd  #$0001
         lbcs  L054D
         cmpd  <u005E,u
         lbhi  L054D
         std   u0008,u
         ldd   <u005E,u
         subd  u0008,u
         std   u0008,u
         leax  >L00AF,pcr
         ldy   #$00C8
         lda   #$01
         os9   I$WritLn 
         leax  >L00D4,pcr
         ldy   #$0001
         lda   #$01
         os9   I$Write  
         leax  >u012E,u
         ldy   #$0020
         clra  
         os9   I$ReadLn 
         cmpy  #$0001
         bls   L02E0
         lda   #$03
         os9   I$Open   
         bcc   L02E6
         ldb   #$03
         os9   I$Create 
         lbcs  L057A
         bra   L02E6
L02E0    lda   #$FF
         sta   u0004,u
         bra   L0301
L02E6    sta   u0004,u
         pshs  u
         ldb   #$02
         os9   I$GetStt 
         os9   I$Seek   
         puls  u
         leax  >L01CC,pcr
         ldy   #$00C8
         lda   #$01
         os9   I$WritLn 
L0301    lda   u0001,u
         leax  >u00EE,u
         ldy   #$0002
         os9   I$Read   
         ldb   #$05
         pshs  u
         os9   I$GetStt 
         leau  -u0002,u
         cmpu  #$0000
         bge   L031F
         leax  -$01,x
L031F    os9   I$Seek   
         puls  u
         lbcs  L057A
         leax  >L01CA,pcr
         ldy   #$0002
         os9   I$Write  
         ldy   #$003E
         leax  >u00EE,u
         leax  $02,x
         os9   I$Read   
         lbcs  L054D
         ldd   <u0038,u
         addd  #$0001
         std   <u0038,u
         ldd   >u00EE,u
         cmpd  #$FFFF
         lbeq  L04CE
         leax  >L0115,pcr
         ldy   >L0139,pcr
         lda   u0004,u
         os9   I$Write  
         leax  >u00F2,u
         ldy   #$00C8
         lda   <u0004
         os9   I$WritLn 
         lbcs  L057A
         leax  >L011E,pcr
         ldy   >L0139,pcr
         lda   u0004,u
         os9   I$Write  
         ldd   >u012C,u
         cmpd  #$FFFF
         beq   L03F0
         leax  >L01A1,pcr
         lda   #$01
         os9   I$Open   
         lbcs  L057A
         sta   u0003,u
L039F    leax  >u01F6,u
         ldy   #$00C8
         lda   u0003,u
         os9   I$ReadLn 
         bcs   L03DB
         leax  >u01F6,u
L03B2    lda   ,x+
         cmpa  #$2C
         bne   L03B2
         lda   #$0D
         sta   -$01,x
         lbsr  L057D
         cmpd  >u012C,u
         bne   L039F
         leax  >u01F6,u
         ldy   #$00C8
         lda   u0004,u
         os9   I$WritLn 
         lda   u0003,u
         os9   I$Close  
         lbra  L03FD
L03DB    leax  >L01B3,pcr
         ldy   #$00C8
         lda   u0004,u
         os9   I$WritLn 
         lda   u0003,u
         os9   I$Close  
         lbra  L03FD
L03F0    leax  >L01C0,pcr
         ldy   #$00C8
         lda   u0004,u
         os9   I$WritLn 
L03FD    leax  >L0127,pcr
         ldy   >L0139,pcr
         lda   u0004,u
         os9   I$Write  
         leax  <u003E,u
         ldb   >u0125,u
         clra  
         lbsr  L05ED
         lda   <u0041,u
         sta   <u004F,u
         lda   <u0042,u
         sta   <u0050,u
         lda   #$2F
         sta   <u0051,u
         ldb   >u0126,u
         clra  
         leax  <u003E,u
         lbsr  L05ED
         lda   <u0041,u
         sta   <u0052,u
         lda   <u0042,u
         sta   <u0053,u
         lda   #$2F
         sta   <u0054,u
         ldb   >u0124,u
         clra  
         leax  <u003E,u
         lbsr  L05ED
         lda   <u0041,u
         sta   <u0055,u
         lda   <u0042,u
         sta   <u0056,u
         lda   #$20
         sta   <u0057,u
         ldb   >u0127,u
         clra  
         leax  <u003E,u
         lbsr  L05ED
         lda   <u0041,u
         sta   <u0058,u
         lda   <u0042,u
         sta   <u0059,u
         lda   #$3A
         sta   <u005A,u
         ldb   >u0128,u
         clra  
         leax  <u003E,u
         lbsr  L05ED
         lda   <u0041,u
         sta   <u005B,u
         lda   <u0042,u
         sta   <u005C,u
         lda   #$0D
         sta   <u005D,u
         leax  <u004F,u
L049A    lda   ,x+
         cmpa  #$20
         beq   L049A
         leax  -$01,x
         ldy   #$00C8
         lda   u0004,u
         os9   I$WritLn 
         lbcs  L057A
         leax  >L0130,pcr
         ldy   >L0139,pcr
         lda   u0004,u
         os9   I$Write  
         leax  >u0106,u
         ldy   #$001E
         os9   I$WritLn 
         lbcs  L057A
         bra   L04D1
L04CE    lbra  L0301
L04D1    leax  >L013B,pcr
         ldy   #$0050
         lda   u0004,u
         os9   I$WritLn 
         lda   u0002,u
         ldx   >u00EE,u
         pshs  u
         ldu   >u00F0,u
         os9   I$Seek   
         lbcs  L057A
         puls  u
L04F3    clra  
         ldb   #$01
         os9   I$GetStt 
         bcs   L050C
         leax  ,u
         ldy   #$0001
         os9   I$Read   
         lda   ,u
         cmpa  #$20
         lbeq  L0301
L050C    lda   u0002,u
         leax  >u009E,u
         ldy   #$0050
         os9   I$ReadLn 
         lda   u0004,u
         os9   I$WritLn 
         cmpy  #$0001
         bhi   L04F3
         leax  >L013B,pcr
         ldy   #$00C8
         lda   u0004,u
         os9   I$WritLn 
         leax  >L017C,pcr
         ldy   #$0005
         os9   I$WritLn 
         ldd   u000A,u
         addd  #$0001
         std   u000A,u
         ldd   <u0038,u
         cmpd  u0008,u
         lbcs  L0301
L054D    lda   u0001,u
         os9   I$Close  
         lda   u0002,u
         os9   I$Close  
         lda   u0003,u
         os9   I$Close  
         lda   u0004,u
         os9   I$Close  
         leax  >L00E9,pcr
         leau  >L017E,pcr
         ldy   #$0001
         lda   #$11
         ldb   #$03
         os9   F$Fork   
         bcs   L057A
         clrb  
         os9   F$Wait   
L057A    os9   F$Exit   
L057D    pshs  y
L057F    lda   ,x+
         cmpa  #$0D
         lbeq  L0669
         cmpa  #$30
         bcs   L057F
         cmpa  #$39
         bhi   L057F
         leax  -$01,x
L0591    lda   ,x+
         cmpa  #$30
         bcs   L059D
         cmpa  #$39
         bhi   L059D
         bra   L0591
L059D    pshs  x
         leax  -$01,x
         clr   <u0030,u
         clr   <u0031,u
         ldd   #$0001
         std   <u0032,u
L05AD    lda   ,-x
         cmpa  #$30
         bcs   L05E6
         cmpa  #$39
         bhi   L05E6
         suba  #$30
         sta   u0006,u
         ldd   #$0000
L05BE    tst   u0006,u
         beq   L05C9
         addd  <u0032,u
         dec   u0006,u
         bra   L05BE
L05C9    addd  <u0030,u
         std   <u0030,u
         lda   #$0A
         sta   u0006,u
         ldd   #$0000
L05D6    tst   u0006,u
         beq   L05E1
         addd  <u0032,u
         dec   u0006,u
         bra   L05D6
L05E1    std   <u0032,u
         bra   L05AD
L05E6    ldd   <u0030,u
         puls  x
         puls  pc,y
L05ED    pshs  x
         std   <u0030,u
         lda   #$30
         sta   ,x
         sta   $01,x
         sta   $02,x
         sta   $03,x
         sta   $04,x
         ldd   #$2710
         std   <u0032,u
         ldd   <u0030,u
         lbsr  L0657
         ldd   #$03E8
         std   <u0032,u
         ldd   <u0030,u
         bsr   L0657
         ldd   #$0064
         std   <u0032,u
         ldd   <u0030,u
         bsr   L0657
         ldd   #$000A
         std   <u0032,u
         ldd   <u0030,u
         bsr   L0657
         ldd   #$0001
         std   <u0032,u
         ldd   <u0030,u
         bsr   L0657
         lda   #$0D
         sta   ,x
         puls  x
         ldb   #$20
L063E    lda   ,x
         cmpa  #$30
         bne   L0648
         stb   ,x+
         bra   L063E
L0648    lda   ,x+
         cmpa  #$30
         bcs   L0654
         cmpa  #$39
         bhi   L0654
         bra   L0648
L0654    leax  -$01,x
         rts   
L0657    subd  <u0032,u
         bcs   L0660
         inc   ,x
         bra   L0657
L0660    addd  <u0032,u
         std   <u0030,u
         leax  $01,x
         rts   
L0669    ldd   #$FFFF
         puls  pc,y
         emod
eom      equ   *
         end
