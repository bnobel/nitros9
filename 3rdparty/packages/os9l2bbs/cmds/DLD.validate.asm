         nam   DLD.validate
         ttl   program module       

* Disassembled 2010/01/24 10:40:56 by Disasm v1.5 (C) 1988 by RML

         ifp1
         use   defsfile
         endc
tylg     set   Prgrm+Objct   
atrv     set   ReEnt+rev
rev      set   $01
         mod   eom,name,tylg,atrv,start,size
u0000    rmb   1
u0001    rmb   1
u0002    rmb   1
u0003    rmb   1
u0004    rmb   1
u0005    rmb   1
u0006    rmb   1
u0007    rmb   1
u0008    rmb   80
u0058    rmb   32
u0078    rmb   2
u007A    rmb   2
u007C    rmb   2
u007E    rmb   2
u0080    rmb   2
u0082    rmb   2
u0084    rmb   1
u0085    rmb   1
u0086    rmb   2
u0088    rmb   1
u0089    rmb   1
u008A    rmb   2
u008C    rmb   2
u008E    rmb   3
u0091    rmb   12
u009D    rmb   2
u009F    rmb   2
u00A1    rmb   27
u00BC    rmb   2
u00BE    rmb   2
u00C0    rmb   1
u00C1    rmb   64
u0101    rmb   8400
size     equ   .
name     equ   *
         fcs   /DLD.validate/
         fcb   $43 C
         fcb   $6F o
         fcb   $70 p
         fcb   $79 y
         fcb   $72 r
         fcb   $69 i
         fcb   $67 g
         fcb   $68 h
         fcb   $74 t
         fcb   $20 
         fcb   $28 (
         fcb   $43 C
         fcb   $29 )
         fcb   $20 
         fcb   $31 1
         fcb   $39 9
         fcb   $38 8
         fcb   $38 8
         fcb   $42 B
         fcb   $79 y
         fcb   $20 
         fcb   $4B K
         fcb   $65 e
         fcb   $69 i
         fcb   $74 t
         fcb   $68 h
         fcb   $20 
         fcb   $41 A
         fcb   $6C l
         fcb   $70 p
         fcb   $68 h
         fcb   $6F o
         fcb   $6E n
         fcb   $73 s
         fcb   $6F o
         fcb   $4C L
         fcb   $69 i
         fcb   $63 c
         fcb   $65 e
         fcb   $6E n
         fcb   $63 c
         fcb   $65 e
         fcb   $64 d
         fcb   $20 
         fcb   $74 t
         fcb   $6F o
         fcb   $20 
         fcb   $41 A
         fcb   $6C l
         fcb   $70 p
         fcb   $68 h
         fcb   $61 a
         fcb   $20 
         fcb   $53 S
         fcb   $6F o
         fcb   $66 f
         fcb   $74 t
         fcb   $77 w
         fcb   $61 a
         fcb   $72 r
         fcb   $65 e
         fcb   $20 
         fcb   $54 T
         fcb   $65 e
         fcb   $63 c
         fcb   $68 h
         fcb   $6E n
         fcb   $6F o
         fcb   $6C l
         fcb   $6F o
         fcb   $67 g
         fcb   $69 i
         fcb   $65 e
         fcb   $73 s
         fcb   $41 A
         fcb   $6C l
         fcb   $6C l
         fcb   $20 
         fcb   $72 r
         fcb   $69 i
         fcb   $67 g
         fcb   $68 h
         fcb   $74 t
         fcb   $73 s
         fcb   $20 
         fcb   $72 r
         fcb   $65 e
         fcb   $73 s
         fcb   $65 e
         fcb   $72 r
         fcb   $76 v
         fcb   $65 e
         fcb   $64 d
         fcb   $EC l
         fcb   $E6 f
         fcb   $EA j
         fcb   $F5 u
         fcb   $E9 i
         fcb   $A0 
         fcb   $E2 b
         fcb   $ED m
         fcb   $F1 q
         fcb   $E9 i
         fcb   $F0 p
         fcb   $EF o
         fcb   $F4 t
         fcb   $F0 p
L0084    fcb   $0A 
         fcb   $0A 
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $45 E
         fcb   $6E n
         fcb   $74 t
         fcb   $65 e
         fcb   $72 r
         fcb   $20 
         fcb   $6C l
         fcb   $6F o
         fcb   $6E n
         fcb   $67 g
         fcb   $20 
         fcb   $64 d
         fcb   $65 e
         fcb   $73 s
         fcb   $63 c
         fcb   $72 r
         fcb   $69 i
         fcb   $70 p
         fcb   $74 t
         fcb   $69 i
         fcb   $6F o
         fcb   $6E n
         fcb   $20 
         fcb   $6E n
         fcb   $6F o
         fcb   $77 w
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $28 (
         fcb   $42 B
         fcb   $6C l
         fcb   $61 a
         fcb   $6E n
         fcb   $6B k
         fcb   $20 
         fcb   $6C l
         fcb   $69 i
         fcb   $6E n
         fcb   $65 e
         fcb   $20 
         fcb   $65 e
         fcb   $6E n
         fcb   $64 d
         fcb   $73 s
         fcb   $29 )
         fcb   $0D 
L00BF    fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $0D 
L0100    fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $45 E
         fcb   $6E n
         fcb   $74 t
         fcb   $65 e
         fcb   $72 r
         fcb   $20 
         fcb   $66 f
         fcb   $69 i
         fcb   $6C l
         fcb   $65 e
         fcb   $20 
         fcb   $6B k
         fcb   $65 e
         fcb   $79 y
         fcb   $77 w
         fcb   $6F o
         fcb   $72 r
         fcb   $64 d
         fcb   $73 s
         fcb   $20 
         fcb   $6E n
         fcb   $6F o
         fcb   $77 w
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $28 (
         fcb   $42 B
         fcb   $6C l
         fcb   $61 a
         fcb   $6E n
         fcb   $6B k
         fcb   $20 
         fcb   $6C l
         fcb   $69 i
         fcb   $6E n
         fcb   $65 e
         fcb   $20 
         fcb   $65 e
         fcb   $6E n
         fcb   $64 d
         fcb   $73 s
         fcb   $29 )
         fcb   $0D 
L013A    fcb   $45 E
         fcb   $6E n
         fcb   $74 t
         fcb   $65 e
         fcb   $72 r
         fcb   $20 
         fcb   $6B k
         fcb   $65 e
         fcb   $79 y
         fcb   $77 w
         fcb   $6F o
         fcb   $72 r
         fcb   $64 d
         fcb   $3A :
L0148    fcb   $0A 
         fcb   $5B [
         fcb   $44 D
         fcb   $5D ]
         fcb   $6F o
         fcb   $6E n
         fcb   $65 e
         fcb   $20 
         fcb   $5B [
         fcb   $45 E
         fcb   $5D ]
         fcb   $64 d
         fcb   $69 i
         fcb   $74 t
         fcb   $20 
         fcb   $5B [
         fcb   $43 C
         fcb   $5D ]
         fcb   $6F o
         fcb   $6E n
         fcb   $74 t
         fcb   $69 i
         fcb   $6E n
         fcb   $75 u
         fcb   $65 e
         fcb   $20 
         fcb   $6F o
         fcb   $72 r
         fcb   $20 
         fcb   $5B [
         fcb   $4C L
         fcb   $5D ]
         fcb   $69 i
         fcb   $73 s
         fcb   $74 t
         fcb   $0D 
L016C    fcb   $45 E
         fcb   $6E n
         fcb   $74 t
         fcb   $65 e
         fcb   $72 r
         fcb   $20 
         fcb   $6C l
         fcb   $69 i
         fcb   $6E n
         fcb   $65 e
         fcb   $20 
         fcb   $23 #
         fcb   $0D 
L0179    fcb   $3E >
L017A    fcb   $0A 
         fcb   $0D 
L017C    fcb   $0A 
         fcb   $50 P
         fcb   $72 r
         fcb   $6F o
         fcb   $67 g
         fcb   $72 r
         fcb   $61 a
         fcb   $6D m
         fcb   $73 s
         fcb   $20 
         fcb   $74 t
         fcb   $6F o
         fcb   $20 
         fcb   $62 b
         fcb   $65 e
         fcb   $20 
         fcb   $76 v
         fcb   $61 a
         fcb   $6C l
         fcb   $69 i
         fcb   $64 d
         fcb   $61 a
         fcb   $74 t
         fcb   $65 e
         fcb   $64 d
         fcb   $0D 
L0196    fcb   $46 F
         fcb   $69 i
         fcb   $6C l
         fcb   $65 e
         fcb   $20 
         fcb   $6E n
         fcb   $61 a
         fcb   $6D m
         fcb   $65 e
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $44 D
         fcb   $65 e
         fcb   $73 s
         fcb   $63 c
         fcb   $72 r
         fcb   $69 i
         fcb   $70 p
         fcb   $74 t
         fcb   $69 i
         fcb   $6F o
         fcb   $6E n
         fcb   $0D 
L01B1    fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $2D -
         fcb   $0D 
L01FE    fcb   $5B [
         fcb   $44 D
         fcb   $5D ]
         fcb   $6F o
         fcb   $77 w
         fcb   $6E n
         fcb   $6C l
         fcb   $6F o
         fcb   $61 a
         fcb   $64 d
         fcb   $2C ,
         fcb   $20 
         fcb   $5B [
         fcb   $56 V
         fcb   $5D ]
         fcb   $61 a
         fcb   $6C l
         fcb   $69 i
         fcb   $64 d
         fcb   $61 a
         fcb   $74 t
         fcb   $65 e
         fcb   $20 
         fcb   $5B [
         fcb   $4B K
         fcb   $5D ]
         fcb   $69 i
         fcb   $6C l
         fcb   $6C l
         fcb   $20 
         fcb   $6F o
         fcb   $72 r
         fcb   $20 
         fcb   $5B [
         fcb   $4E N
         fcb   $5D ]
         fcb   $65 e
         fcb   $78 x
         fcb   $74 t
         fcb   $3A :
L0226    fcb   $44 D
         fcb   $4C L
         fcb   $44 D
         fcb   $2E .
         fcb   $6C l
         fcb   $73 s
         fcb   $74 t
         fcb   $0D 
L022E    fcb   $44 D
         fcb   $4C L
         fcb   $44 D
         fcb   $2E .
         fcb   $64 d
         fcb   $73 s
         fcb   $63 c
         fcb   $0D 
L0236    fcb   $44 D
         fcb   $4C L
         fcb   $44 D
         fcb   $2E .
         fcb   $6B k
         fcb   $65 e
         fcb   $79 y
         fcb   $0D 
L023E    fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $20 
         fcb   $20 
L028D    fcb   $0D 
         fcb   $0A 
         fcb   $45 E
         fcb   $6E n
         fcb   $74 t
         fcb   $65 e
         fcb   $72 r
         fcb   $20 
         fcb   $79 y
         fcb   $6F o
         fcb   $75 u
         fcb   $72 r
         fcb   $20 
         fcb   $64 d
         fcb   $6F o
         fcb   $77 w
         fcb   $6E n
         fcb   $6C l
         fcb   $6F o
         fcb   $61 a
         fcb   $64 d
         fcb   $20 
         fcb   $70 p
         fcb   $72 r
         fcb   $6F o
         fcb   $74 t
         fcb   $6F o
         fcb   $63 c
         fcb   $6F o
         fcb   $6C l
         fcb   $0D 
L02AC    fcb   $0A 
         fcb   $0D 
         fcb   $5B [
         fcb   $58 X
         fcb   $5D ]
         fcb   $20 
         fcb   $78 x
         fcb   $6D m
         fcb   $6F o
         fcb   $64 d
         fcb   $65 e
         fcb   $6D m
         fcb   $0A 
         fcb   $0D 
         fcb   $5B [
         fcb   $43 C
         fcb   $5D ]
         fcb   $20 
         fcb   $78 x
         fcb   $6D m
         fcb   $6F o
         fcb   $64 d
         fcb   $65 e
         fcb   $6D m
         fcb   $20 
         fcb   $28 (
         fcb   $43 C
         fcb   $52 R
         fcb   $43 C
         fcb   $29 )
         fcb   $0A 
         fcb   $0D 
         fcb   $5B [
         fcb   $59 Y
         fcb   $5D ]
         fcb   $20 
         fcb   $79 y
         fcb   $6D m
         fcb   $6F o
         fcb   $64 d
         fcb   $65 e
         fcb   $6D m
         fcb   $0A 
         fcb   $0D 
         fcb   $5B [
         fcb   $51 Q
         fcb   $5D ]
         fcb   $20 
         fcb   $71 q
         fcb   $75 u
         fcb   $69 i
         fcb   $74 t
         fcb   $0A 
         fcb   $0D 
         fcb   $50 P
         fcb   $72 r
         fcb   $6F o
         fcb   $74 t
         fcb   $6F o
         fcb   $63 c
         fcb   $6F o
         fcb   $6C l
         fcb   $3F ?
L02EB    fcb   $64 d
         fcb   $6C l
         fcb   $6F o
         fcb   $61 a
         fcb   $64 d
         fcb   $78 x
         fcb   $0D 
L02F2    fcb   $64 d
         fcb   $6C l
         fcb   $6F o
         fcb   $61 a
         fcb   $64 d
         fcb   $78 x
         fcb   $63 c
         fcb   $0D 
L02FA    fcb   $64 d
         fcb   $6C l
         fcb   $6F o
         fcb   $61 a
         fcb   $64 d
         fcb   $79 y
         fcb   $0D 
L0301    fcb   $64 d
         fcb   $6C l
         fcb   $6F o
         fcb   $61 a
         fcb   $64 d
         fcb   $79 y
         fcb   $62 b
         fcb   $0D 
L0309    fcb   $0A 
         fcb   $45 E
         fcb   $6E n
         fcb   $74 t
         fcb   $65 e
         fcb   $72 r
         fcb   $20 
         fcb   $61 a
         fcb   $20 
         fcb   $6F o
         fcb   $6E n
         fcb   $65 e
         fcb   $20 
         fcb   $6C l
         fcb   $69 i
         fcb   $6E n
         fcb   $65 e
         fcb   $20 
         fcb   $64 d
         fcb   $65 e
         fcb   $73 s
         fcb   $63 c
         fcb   $72 r
         fcb   $69 i
         fcb   $70 p
         fcb   $74 t
         fcb   $69 i
         fcb   $6F o
         fcb   $6E n
         fcb   $0D 
L0327    fcb   $44 D
         fcb   $65 e
         fcb   $6C l
         fcb   $65 e
         fcb   $74 t
         fcb   $65 e
         fcb   $20 
         fcb   $66 f
         fcb   $69 i
         fcb   $6C l
         fcb   $65 e
         fcb   $3F ?
         fcb   $20 
         fcb   $28 (
         fcb   $59 Y
         fcb   $2F /
         fcb   $4E N
         fcb   $29 )
         fcb   $3A :
L033A    fcb   $08 
         fcb   $20 
         fcb   $08 
start    equ   *
         lda   ,x
         cmpa  #$0D
         beq   L034C
         lda   #$01
         os9   I$ChgDir 
         lbcs  L088E
L034C    leax  >L0236,pcr
         lda   #$02
         os9   I$Open   
         bcc   L0366
         cmpb  #$D8
         lbne  L088E
         ldb   #$1B
         os9   I$Create 
         lbcs  L088E
L0366    sta   u0003,u
         leax  >L022E,pcr
         lda   #$03
         os9   I$Open   
         bcc   L0382
         cmpb  #$D8
         lbne  L088E
         ldb   #$1B
         os9   I$Create 
         lbcs  L088E
L0382    sta   u0004,u
         leax  >L017C,pcr
         ldy   #$00C8
         lda   #$01
         os9   I$WritLn 
         leax  >L0196,pcr
         ldy   #$00C8
         os9   I$WritLn 
         leax  >L01B1,pcr
         ldy   #$00C8
         os9   I$WritLn 
         ldx   #$0000
         stx   <u0078,u
         stx   <u007A,u
         stx   <u007C,u
         stx   <u007E,u
         leax  >L0226,pcr
         lda   #$03
         os9   I$Open   
         lbcs  L088E
         sta   u0002,u
L03C5    ldd   <u0078,u
         std   >u0080,u
         ldd   <u007A,u
         std   >u0082,u
         lda   u0002,u
         pshs  u
         ldx   <u0078,u
         ldu   <u007A,u
         os9   I$Seek   
         puls  u
         leax  >u00A1,u
         ldy   #$0060
         os9   I$Read   
         lbcs  L0507
         pshs  u
         ldb   #$05
         os9   I$GetStt 
         tfr   u,y
         puls  u
         stx   <u0078,u
         sty   <u007A,u
         tst   >u00C0,u
         lbne  L07F2
         clrb  
         leax  >u00A1,u
L0410    lda   ,x+
         cmpa  #$0D
         beq   L0419
         incb  
         bra   L0410
L0419    stb   u0006,u
         clra  
         tfr   d,y
         leax  >u00A1,u
         lda   #$01
         os9   I$Write  
         ldb   #$0F
         subb  u0006,u
         blt   L0439
         clra  
         tfr   d,y
         lda   #$01
         leax  >L023E,pcr
         os9   I$Write  
L0439    leax  >u00C1,u
         ldy   #$0041
         lda   #$01
         os9   I$WritLn 
L0446    leax  >L01FE,pcr
         ldy   #$0028
         lda   #$01
         os9   I$Write  
         leax  u0005,u
         ldy   #$0001
         clra  
         os9   I$Read   
         leax  >L028D,pcr
         ldy   #$0001
         lda   #$01
         os9   I$WritLn 
         lda   u0005,u
         anda  #$DF
         cmpa  #$56
         lbeq  L0489
         cmpa  #$44
         lbeq  L077A
         cmpa  #$4E
         lbeq  L07F2
         cmpa  #$4B
         lbeq  L0821
         lbra  L0446
L0489    leax  >L0309,pcr
         ldy   #$00C8
         lda   #$01
         os9   I$WritLn 
         leax  >L0179,pcr
         ldy   #$0001
         lda   #$01
         os9   I$Write  
         leax  >u00C1,u
         ldy   #$0040
         clra  
         os9   I$ReadLn 
         lda   #$FF
         sta   >u00C0,u
         lda   u0004,u
         ldb   #$02
         pshs  u
         os9   I$GetStt 
         lbcs  L088E
         os9   I$Seek   
         lbcs  L088E
         tfr   u,y
         puls  u
         stx   >u00BC,u
         sty   >u00BE,u
         lda   u0002,u
         pshs  u
         ldx   <u007C,u
         ldu   <u007E,u
         os9   I$Seek   
         puls  u
         leax  >u00A1,u
         ldy   #$0060
         lda   u0002,u
         os9   I$Write  
         pshs  u
         ldb   #$05
         os9   I$GetStt 
         tfr   u,y
         puls  u
         stx   <u007C,u
         sty   <u007E,u
         lbra  L0521
L0507    cmpb  #$D3
         lbne  L088E
         lda   u0002,u
         ldb   #$02
         pshs  u
         ldx   <u007C,u
         ldu   <u007E,u
         os9   I$SetStt 
         puls  u
         lbra  L088D
L0521    lda   u0003,u
         ldb   #$02
         pshs  u
         os9   I$GetStt 
         lbcs  L088E
         os9   I$Seek   
         lbcs  L088E
         puls  u
         leax  >L0100,pcr
         ldy   #$00C8
         lda   #$01
         os9   I$WritLn 
         leax  >L00BF,pcr
         ldy   #$0041
         lda   #$01
         os9   I$WritLn 
         ldd   >u0080,u
         std   >u009D,u
         ldd   >u0082,u
         std   >u009F,u
L0561    leax  >L013A,pcr
         ldy   #$000E
         lda   #$01
         os9   I$Write  
         leax  >u0091,u
         ldy   #$000C
         clra  
         os9   I$ReadLn 
         lbcs  L0561
         cmpy  #$0001
         lbls  L0591
         lda   u0003,u
         ldy   #$0010
         os9   I$Write  
         bra   L0561
L0591    leax  >L0084,pcr
         ldy   #$00C8
         lda   #$01
         os9   I$WritLn 
         lbcs  L088E
         leax  >L00BF,pcr
         ldy   #$0050
         os9   I$WritLn 
         lbcs  L088E
         ldd   #$0000
         std   >u0084,u
         sta   u0007,u
L05BA    ldd   >u0084,u
         addd  #$0001
         std   >u0084,u
         cmpd  #$0063
         bge   L05D6
         lbsr  L06EF
         cmpy  #$0001
         bls   L05D6
         bra   L05BA
L05D6    leax  >L0148,pcr
         ldy   #$00C8
         lda   #$01
         os9   I$WritLn 
         leax  >L0179,pcr
         ldy   #$0001
         os9   I$Write  
         leax  u0005,u
         clra  
         ldy   #$0001
         os9   I$Read   
         leax  >L017A,pcr
         ldy   #$0001
         lda   #$01
         os9   I$WritLn 
         lda   u0005,u
         anda  #$DF
         cmpa  #$44
         lbeq  L0742
         cmpa  #$45
         beq   L062C
         cmpa  #$43
         beq   L061F
         cmpa  #$4C
         lbeq  L06A6
         bra   L05D6
L061F    ldd   >u0084,u
         subd  #$0001
         std   >u0084,u
         bra   L05BA
L062C    leax  >L016C,pcr
         ldy   #$00C8
         lda   #$01
         os9   I$WritLn 
         leax  >L0179,pcr
         ldy   #$0001
         os9   I$Write  
         clra  
         leax  >u008E,u
         ldy   #$0003
         os9   I$ReadLn 
         lbsr  L0A1D
         cmpd  >u0084,u
         lbcc  L05D6
         std   >u008C,u
         leax  >u008E,u
         lbsr  L0A96
         leax  >u008E,u
         lda   #$3A
         sta   $02,x
         ldy   #$0003
         lda   #$01
         os9   I$Write  
         ldd   >u008C,u
         leax  >u0101,u
         lda   #$50
         mul   
         leax  d,x
         ldy   #$0050
         lda   #$01
         os9   I$WritLn 
         tfr   y,d
         stb   u0007,u
         dec   u0007,u
         leay  u0008,u
L0696    lda   ,x+
         sta   ,y+
         decb  
         bne   L0696
         ldd   >u008C,u
         bsr   L06EF
         lbra  L05D6
L06A6    ldd   #$0000
         std   >u0084,u
L06AD    ldd   >u0084,u
         addd  #$0001
         std   >u0084,u
         leax  >u008E,u
         lbsr  L0A96
         leax  >u008E,u
         lda   #$3A
         sta   $02,x
         lda   #$01
         ldy   #$0003
         os9   I$Write  
         leax  >u0101,u
         ldd   >u0084,u
         lda   #$50
         mul   
         leax  d,x
         ldy   #$0050
         lda   #$01
         os9   I$WritLn 
         cmpy  #$0001
         bhi   L06AD
         lbra  L05D6
L06EF    leax  >u008E,u
         pshs  b,a
         lbsr  L0A96
         leax  >u008E,u
         lda   #$3A
         sta   $02,x
         lda   #$01
         ldy   #$0003
         os9   I$Write  
         lbcs  L088E
         leax  u0008,u
         ldb   u0007,u
         clra  
         tfr   d,y
         lda   #$01
         os9   I$Write  
         puls  b,a
         lda   #$50
         mul   
         leax  >u0101,u
         leax  d,x
         leay  u0008,u
         ldb   #$50
         lda   u0007,u
         beq   L073B
         sta   >u0088,u
L0730    lda   ,y+
         sta   ,x+
         decb  
         dec   >u0088,u
         bne   L0730
L073B    clra  
         tfr   d,y
         lbsr  L0891
         rts   
L0742    lda   #$00
         sta   >u0086,u
L0748    lda   >u0086,u
         inca  
         sta   >u0086,u
         cmpa  >u0085,u
         bhi   L0777
         ldb   #$50
         mul   
         leax  >u0101,u
         leax  d,x
         ldy   #$0050
         lda   u0004,u
         os9   I$WritLn 
         lbcs  L088E
         cmpy  #$0001
         bls   L0777
         tfr   y,d
         bra   L0748
L0777    lbra  L03C5
L077A    leax  >L02AC,pcr
         ldy   #$003F
         lda   #$01
         os9   I$Write  
         leax  u0005,u
         ldy   #$0001
         clra  
         os9   I$Read   
         leax  >L028D,pcr
         ldy   #$0001
         lda   #$01
         os9   I$WritLn 
         lda   u0005,u
         anda  #$DF
         cmpa  #$58
         beq   L07B6
         cmpa  #$43
         beq   L07BC
         cmpa  #$59
         beq   L07C2
         cmpa  #$51
         lbeq  L088D
         bra   L077A
L07B6    leax  >L02EB,pcr
         bra   L07CC
L07BC    leax  >L02F2,pcr
         bra   L07CC
L07C2    leax  >L02FA,pcr
         bra   L07CC
         leax  >L0301,pcr
L07CC    ldb   u0006,u
         incb  
         clra  
         tfr   d,y
         lda   #$11
         ldb   #$03
         pshs  u
         leau  >u00A1,u
         os9   F$Fork   
         lbcs  L088E
         clrb  
         os9   F$Wait   
         lbcs  L088E
         puls  u
         tstb  
         lbne  L077A
L07F2    lda   u0002,u
         pshs  u
         ldx   <u007C,u
         ldu   <u007E,u
         os9   I$Seek   
         puls  u
         leax  >u00A1,u
         ldy   #$0060
         os9   I$Write  
         pshs  u
         ldb   #$05
         os9   I$GetStt 
         tfr   u,y
         puls  u
         stx   <u007C,u
         sty   <u007E,u
         lbra  L03C5
L0821    leax  >L0327,pcr
         ldy   #$0013
         lda   #$01
         os9   I$Write  
         leax  u0005,u
         ldy   #$0001
         clra  
         os9   I$Read   
         leax  >L017A,pcr
         ldy   #$0001
         lda   #$01
         os9   I$WritLn 
         lda   u0005,u
         anda  #$DF
         cmpa  #$59
         lbne  L07F2
         leax  >u00A1,u
         os9   I$Delete 
         lda   #$01
         sta   >u00C0,u
         lda   u0002,u
         pshs  u
         ldx   <u007C,u
         ldu   <u007E,u
         os9   I$Seek   
         puls  u
         leax  >u00A1,u
         ldy   #$0060
         lda   u0002,u
         os9   I$Write  
         pshs  u
         ldb   #$05
         os9   I$GetStt 
         tfr   u,y
         puls  u
         stx   <u007C,u
         sty   <u007E,u
         lbra  L03C5
L088D    clrb  
L088E    os9   F$Exit   
L0891    lbsr  L09E8
         ldb   u0007,u
         leay  b,y
         pshs  y
         negb  
         sex   
         leay  d,y
         clr   u0007,u
         cmpy  #$0000
         lbeq  L0960
         pshs  y,x
         lda   #$0D
L08AC    sta   ,x+
         leay  -$01,y
         bne   L08AC
         puls  y,x
L08B4    pshs  y,x
         leax  u0005,u
         ldy   #$0001
         clra  
         os9   I$Read   
         bcs   L08ED
         lda   u0005,u
         cmpa  #$01
         beq   L08F1
         cmpa  #$08
         beq   L0913
         cmpa  #$18
         beq   L0937
         cmpa  #$0D
         lbeq  L095E
         cmpa  #$20
         bcs   L08ED
         lda   #$01
         os9   I$Write  
         puls  y,x
         lda   u0005,u
         sta   ,x+
         leay  -$01,y
         lbeq  L0987
         bra   L08B4
L08ED    puls  y,x
         bra   L08B4
L08F1    puls  y,x
         leay  -$01,y
         beq   L090E
         lda   ,x+
         cmpa  #$0D
         beq   L090C
         pshs  y,x
         leax  -$01,x
         ldy   #$0001
         lda   #$01
         os9   I$Write  
         bra   L08F1
L090C    leax  -$01,x
L090E    leay  $01,y
         lbra  L08B4
L0913    puls  y,x
         leay  $01,y
         cmpy  ,s
         bhi   L0932
         pshs  y,x
         leax  >L033A,pcr
         ldy   #$0003
         lda   #$01
         os9   I$Write  
         puls  y,x
         leax  -$01,x
         lbra  L08B4
L0932    leay  -$01,y
         lbra  L08B4
L0937    puls  y,x
         leay  $01,y
         cmpy  ,s
         bhi   L0932
         pshs  y,x
         leax  >L033A,pcr
         ldy   #$0003
         lda   #$01
         os9   I$Write  
         puls  y,x
         leax  -$01,x
         cmpy  ,s
         lbhi  L08B4
         pshs  y,x
         bra   L0937
L095E    puls  y,x
L0960    lda   #$0D
         sta   ,x+
         pshs  y,x
         leax  >L017A,pcr
         ldy   #$0001
         lda   #$01
         os9   I$WritLn 
         puls  y,x
         puls  b,a
         pshs  y
         subd  ,s
         leas  $02,s
         tfr   d,y
         leay  $01,y
         lbsr  L0A01
         rts   
         puls  y,x
L0987    puls  b,a
         pshs  y
         subd  ,s
         leas  $02,s
         addd  #$0001
         tfr   d,y
         clrb  
L0995    leay  -$01,y
         beq   L09B3
         lda   ,-x
         cmpa  #$20
         beq   L09C4
         pshs  y,x
         leax  >L033A,pcr
         ldy   #$0003
         lda   #$01
         os9   I$Write  
         incb  
         puls  y,x
         bra   L0995
L09B3    lda   #$0D
         sta   <$4F,x
         ldy   #$00C8
         lda   #$01
         os9   I$WritLn 
         puls  y
         rts   
L09C4    lda   #$0D
         sta   ,x+
         pshs  y,x
         stb   u0007,u
         leay  u0008,u
L09CE    lda   ,x+
         sta   ,y+
         decb  
         bne   L09CE
         leax  >L017A,pcr
         ldy   #$0001
         lda   #$01
         os9   I$WritLn 
         puls  y,x
         lbsr  L0A01
         rts   
L09E8    pshs  y,x,b,a
         leax  <u0058,u
         clra  
         ldb   #$00
         os9   I$GetStt 
         leax  <-$20,x
         clr   <$24,x
         leax  <$20,x
         os9   I$SetStt 
         puls  pc,y,x,b,a
L0A01    pshs  y,x,b,a
         leax  <u0058,u
         clra  
         ldb   #$00
         os9   I$GetStt 
         leax  <-$20,x
         lda   #$01
         sta   <$24,x
         leax  <$20,x
         clra  
         os9   I$SetStt 
         puls  pc,y,x,b,a
L0A1D    pshs  y
L0A1F    lda   ,x+
         cmpa  #$0D
         lbeq  L0AD7
         cmpa  #$30
         bcs   L0A1F
         cmpa  #$39
         bhi   L0A1F
         leax  -$01,x
L0A31    lda   ,x+
         cmpa  #$30
         bcs   L0A3D
         cmpa  #$39
         bhi   L0A3D
         bra   L0A31
L0A3D    pshs  x
         leax  -$01,x
         clr   >u0088,u
         clr   >u0089,u
         ldd   #$0001
         std   >u008A,u
L0A50    lda   ,-x
         cmpa  #$30
         bcs   L0A8E
         cmpa  #$39
         bhi   L0A8E
         suba  #$30
         sta   u0001,u
         ldd   #$0000
L0A61    tst   u0001,u
         beq   L0A6D
         addd  >u008A,u
         dec   u0001,u
         bra   L0A61
L0A6D    addd  >u0088,u
         std   >u0088,u
         lda   #$0A
         sta   u0001,u
         ldd   #$0000
L0A7C    tst   u0001,u
         beq   L0A88
         addd  >u008A,u
         dec   u0001,u
         bra   L0A7C
L0A88    std   >u008A,u
         bra   L0A50
L0A8E    ldd   >u0088,u
         puls  x
         puls  pc,y
L0A96    pshs  y
         std   >u0088,u
         lda   #$30
         sta   ,x
         sta   $01,x
         ldd   #$000A
         std   >u008A,u
         ldd   >u0088,u
         bsr   L0AC2
         ldd   #$0001
         std   >u008A,u
         ldd   >u0088,u
         bsr   L0AC2
         lda   #$0D
         sta   ,x
         puls  pc,y
L0AC2    subd  >u008A,u
         bcs   L0ACC
         inc   ,x
         bra   L0AC2
L0ACC    addd  >u008A,u
         std   >u0088,u
         leax  $01,x
         rts   
L0AD7    ldd   #$FFFF
         puls  pc,y
         emod
eom      equ   *
         end
